# U盾/CA证书到期提醒系统 - 项目开发总结报告

**版本**: 1.0.0  
**日期**: 2026-01-16  
**作者**: 海边的飞行器 (18520403199)

---

## 1. 项目背景与目标
针对企业或个人持有的关键资产（如银行U盾、CA数字证书、域名、服务器、保险等）存在有效期管理困难、容易遗忘续费导致业务中断的痛点，开发一套轻量级、高可靠的**自动化到期提醒系统**。

核心目标是实现“**零遗漏**”的通知机制，通过高频、多渠道触达用户，直至用户完成续费更新。

## 2. 技术架构

本项目采用现代化的 **Serverless** 和 **BaaS (Backend as a Service)** 架构，确保了系统的低成本、高可用和易维护性。

*   **前端 (Frontend)**:
    *   **框架**: React + TypeScript + Vite
    *   **UI库**: Tailwind CSS + Headless UI
    *   **图标**: Lucide React
    *   **构建与部署**: Netlify (自动化 CI/CD)
*   **后端 (Backend)**:
    *   **核心服务**: Supabase (基于 PostgreSQL)
    *   **身份认证**: Supabase Auth (Email/Password)
    *   **数据库安全**: Row Level Security (RLS) 实现多租户数据隔离
*   **云逻辑 (Cloud Logic)**:
    *   **定时任务**: Supabase pg_cron
    *   **业务逻辑**: Supabase Edge Functions (Deno / TypeScript)
*   **通知服务 (Notification)**:
    *   **邮件**: Resend API
    *   **微信**: PushPlus (微信公众号推送)

## 3. 核心功能模块

### 3.1 资产管理
*   **支持类型**: U-Key、CA证书、域名 (Domain)、服务器 (Server)、保险 (Insurance)、其他。
*   **CRUD操作**: 支持资产的增删改查。
*   **排序功能**: 支持按名称、类型、到期日进行升序/降序排列。
*   **个性化设置**: 用户可记录续费方式、关联网站及备注信息。

### 3.2 智能提醒策略 (核心亮点)
系统采用了激进的“**防遗漏**”提醒策略：
1.  **启动时间**: 资产到期前 **10天** 开始介入。
2.  **高频轰炸**: 每日发送 **3次** 提醒（北京时间 **09:30, 14:30, 21:00**），覆盖工作与休息时段。
3.  **持续追踪**: 若资产已过期且未在系统中更新日期，系统将**持续每日发送**严重过期警告，直到用户修改日期为止。

### 3.3 多渠道通知
*   **邮件通知**: HTML 格式邮件，根据剩余天数显示不同颜色（橙色预警、红色紧急）。
*   **微信通知**: 通过 PushPlus 接口推送到用户微信，支持手机端即时查看。
*   **通知管理**:
    *   用户可在 Dashboard 配置自己的 PushPlus Token。
    *   **按需关闭**: 单个资产支持“关闭提醒”开关。
    *   **安全确认**: 关闭提醒时弹出原生确认框，警示业务中断风险，防止误操作。

### 3.4 安全与隐私
*   **多租户隔离**: 严格的 RLS 策略，确保用户A无法查看用户B的任何资产数据。
*   **数据加密**: 敏感 Token 存储在受保护的 Profiles 表中。

## 4. 数据库设计摘要

### 4.1 `assets` 表 (资产表)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | uuid | 主键 |
| user_id | uuid | 关联 auth.users |
| name | text | 资产名称 |
| type | text | 资产类型 |
| expiry_date | date | 到期日期 |
| notification_enabled | boolean | 是否开启提醒 (默认 true) |
| websites | text[] | 关联网站数组 |

### 4.2 `profiles` 表 (用户配置表)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | uuid | 关联 auth.users |
| wechat_webhook | text | PushPlus Token |
| notify_days | integer[] | (已废弃，改用 Edge Function 硬编码逻辑) |

## 5. 部署信息

*   **前端访问地址**: [https://u-key-reminder.netlify.app](https://u-key-reminder.netlify.app)
*   **代码仓库**: GitHub (u-key-reminder)
*   **后端服务**: Supabase Project (owftlotklqlvtedevzsx)

## 6. 后续迭代建议
1.  **短信通知**: 对接阿里云或腾讯云短信接口，增加短信渠道。
2.  **日历订阅**: 生成 .ics 订阅链接，允许用户将到期日同步到手机系统日历。
3.  **团队协作**: 允许主账号创建子账号，实现企业级多人管理同一批资产。

---
*Generated by Trae AI Pair Programmer*
